{"ast":null,"code":"import { getItemCount } from '@react-stately/collections';\nimport { getItemId } from './utils';\nimport { isFocusVisible } from '@react-aria/interactions';\nimport { useHover, usePress } from '@react-native-aria/interactions';\nimport { isMac, isWebKit, mergeProps, useSlotId } from '@react-aria/utils';\nimport { useSelectableItem } from '@react-aria/selection';\nimport { useMapDomPropsToRN } from '@react-native-aria/utils';\n\n/**\n * Provides the behavior and accessibility implementation for an option in a listbox.\n * See `useListBox` for more details about listboxes.\n * @param props - Props for the option.\n * @param state - State for the listbox, as returned by `useListState`.\n */\nexport function useOption(props, state, ref) {\n  let {\n    isSelected,\n    isDisabled,\n    key,\n    shouldSelectOnPressUp,\n    shouldFocusOnHover,\n    isVirtualized,\n    shouldUseVirtualFocus\n  } = props;\n  let labelId = useSlotId();\n  let descriptionId = useSlotId();\n  let _optionProps = {\n    'role': 'option',\n    'aria-disabled': isDisabled,\n    'aria-selected': isSelected\n  }; // Safari with VoiceOver on macOS misreads options with aria-labelledby or aria-label as simply \"text\".\n  // We should not map slots to the label and description on Safari and instead just have VoiceOver read the textContent.\n  // https://bugs.webkit.org/show_bug.cgi?id=209279\n\n  if (!(isMac() && isWebKit())) {\n    _optionProps['aria-label'] = props['aria-label'];\n    _optionProps['aria-labelledby'] = labelId;\n    _optionProps['aria-describedby'] = descriptionId;\n  }\n  if (isVirtualized) {\n    //@ts-ignore\n    _optionProps['aria-posinset'] = state.collection.getItem(key).index + 1;\n    _optionProps['aria-setsize'] = getItemCount(state.collection);\n  }\n  let {\n    itemProps\n  } = useSelectableItem({\n    selectionManager: state.selectionManager,\n    //@ts-ignore\n    key,\n    ref,\n    shouldSelectOnPressUp,\n    isVirtualized,\n    shouldUseVirtualFocus\n  });\n  let {\n    pressProps\n  } = usePress({\n    ...itemProps,\n    isDisabled,\n    preventFocusOnPress: shouldUseVirtualFocus\n  });\n  let {\n    hoverProps\n  } = useHover({\n    isDisabled: isDisabled || !shouldFocusOnHover,\n    onHoverStart() {\n      if (!isFocusVisible()) {\n        state.selectionManager.setFocused(true); //@ts-ignore\n\n        state.selectionManager.setFocusedKey(key);\n      }\n    }\n  }, ref); // Putting this as a last resort, after several hours of debugging.\n  // Why?\n  // tabListProps adds onMouseDown with preventDefault in useSelectableCollection.ts (React Aria) and react-native-web uses onClick for onPress.\n  // This results in tab button not getting focused when clicked\n  // See this example - https://codesandbox.io/s/issue-i-know-but-dont-know-why-1-ydyw5?file=/src/App.js\n\n  const onMouseDown = e => e.stopPropagation();\n  _optionProps = {\n    ..._optionProps,\n    ...mergeProps(pressProps, hoverProps),\n    //@ts-ignore\n    id: getItemId(state, key),\n    onMouseDown\n  };\n  const optionProps = useMapDomPropsToRN(_optionProps, ref);\n  return {\n    optionProps,\n    labelProps: {\n      nativeID: labelId\n    },\n    descriptionProps: {\n      nativeID: descriptionId\n    }\n  };\n}","map":{"version":3,"mappings":"AAAA,SAASA,YAAT,QAA6B,4BAA7B;AACA,SAASC,SAAT,QAA0B,SAA1B;AAEA,SAASC,cAAT,QAA+B,0BAA/B;AACA,SAASC,QAAT,EAAmBC,QAAnB,QAAmC,iCAAnC;AACA,SAASC,KAAT,EAAgBC,QAAhB,EAA0BC,UAA1B,EAAsCC,SAAtC,QAAuD,mBAAvD;AAEA,SAASC,iBAAT,QAAkC,uBAAlC;AACA,SAASC,kBAAT,QAAmC,0BAAnC;;AAuCA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,SAAT,CACLC,KADK,EAELC,KAFK,EAGLC,GAHK,EAIO;EACZ,IAAI;IACFC,UADE;IAEFC,UAFE;IAGFC,GAHE;IAIFC,qBAJE;IAKFC,kBALE;IAMFC,aANE;IAOFC;EAPE,IAQAT,KARJ;EAUA,IAAIU,OAAO,GAAGd,SAAS,EAAvB;EACA,IAAIe,aAAa,GAAGf,SAAS,EAA7B;EAEA,IAAIgB,YAAiB,GAAG;IACtB,QAAQ,QADc;IAEtB,iBAAiBR,UAFK;IAGtB,iBAAiBD;EAHK,CAAxB,CAdY,CAoBZ;EACA;EACA;;EACA,IAAI,EAAEV,KAAK,MAAMC,QAAQ,EAArB,CAAJ,EAA8B;IAC5BkB,YAAY,CAAC,YAAD,CAAZ,GAA6BZ,KAAK,CAAC,YAAD,CAAlC;IACAY,YAAY,CAAC,iBAAD,CAAZ,GAAkCF,OAAlC;IACAE,YAAY,CAAC,kBAAD,CAAZ,GAAmCD,aAAnC;EACD;EAED,IAAIH,aAAJ,EAAmB;IACjB;IACAI,YAAY,CAAC,eAAD,CAAZ,GAAgCX,KAAK,CAACY,UAAN,CAAiBC,OAAjB,CAAyBT,GAAzB,EAA8BU,KAA9B,GAAsC,CAAtE;IACAH,YAAY,CAAC,cAAD,CAAZ,GAA+BxB,YAAY,CAACa,KAAK,CAACY,UAAP,CAA3C;EACD;EAED,IAAI;IAAEG;EAAF,IAAgBnB,iBAAiB,CAAC;IACpCoB,gBAAgB,EAAEhB,KAAK,CAACgB,gBADY;IAEpC;IACAZ,GAHoC;IAIpCH,GAJoC;IAKpCI,qBALoC;IAMpCE,aANoC;IAOpCC;EAPoC,CAAD,CAArC;EAUA,IAAI;IAAES;EAAF,IAAiB1B,QAAQ,CAAC;IAC5B,GAAGwB,SADyB;IAE5BZ,UAF4B;IAG5Be,mBAAmB,EAAEV;EAHO,CAAD,CAA7B;EAMA,IAAI;IAAEW;EAAF,IAAiB7B,QAAQ,CAC3B;IACEa,UAAU,EAAEA,UAAU,IAAI,CAACG,kBAD7B;IAEEc,YAAY,GAAG;MACb,IAAI,CAAC/B,cAAc,EAAnB,EAAuB;QACrBW,KAAK,CAACgB,gBAAN,CAAuBK,UAAvB,CAAkC,IAAlC,EADqB,CAErB;;QACArB,KAAK,CAACgB,gBAAN,CAAuBM,aAAvB,CAAqClB,GAArC;MACD;IACF;EARH,CAD2B,EAW3BH,GAX2B,CAA7B,CAnDY,CAiEZ;EACA;EACA;EACA;EACA;;EACA,MAAMsB,WAAW,GAAIC,CAAD,IAAYA,CAAC,CAACC,eAAF,EAAhC;EAEAd,YAAY,GAAG;IACb,GAAGA,YADU;IAEb,GAAGjB,UAAU,CAACuB,UAAD,EAAaE,UAAb,CAFA;IAGb;IACAO,EAAE,EAAEtC,SAAS,CAACY,KAAD,EAAQI,GAAR,CAJA;IAKbmB;EALa,CAAf;EAQA,MAAMI,WAAW,GAAG9B,kBAAkB,CAACc,YAAD,EAAeV,GAAf,CAAtC;EAEA,OAAO;IACL0B,WADK;IAELC,UAAU,EAAE;MACVC,QAAQ,EAAEpB;IADA,CAFP;IAKLqB,gBAAgB,EAAE;MAChBD,QAAQ,EAAEnB;IADM;EALb,CAAP;AASD","names":["getItemCount","getItemId","isFocusVisible","useHover","usePress","isMac","isWebKit","mergeProps","useSlotId","useSelectableItem","useMapDomPropsToRN","useOption","props","state","ref","isSelected","isDisabled","key","shouldSelectOnPressUp","shouldFocusOnHover","isVirtualized","shouldUseVirtualFocus","labelId","descriptionId","_optionProps","collection","getItem","index","itemProps","selectionManager","pressProps","preventFocusOnPress","hoverProps","onHoverStart","setFocused","setFocusedKey","onMouseDown","e","stopPropagation","id","optionProps","labelProps","nativeID","descriptionProps"],"sources":["C:\\Users\\user\\node_modules\\@react-native-aria\\listbox\\lib\\module\\useOption.web.ts"],"sourcesContent":["import { getItemCount } from '@react-stately/collections';\nimport { getItemId } from './utils';\nimport { Key, RefObject } from 'react';\nimport { isFocusVisible } from '@react-aria/interactions';\nimport { useHover, usePress } from '@react-native-aria/interactions';\nimport { isMac, isWebKit, mergeProps, useSlotId } from '@react-aria/utils';\nimport { ListState } from '@react-stately/list';\nimport { useSelectableItem } from '@react-aria/selection';\nimport { useMapDomPropsToRN } from '@react-native-aria/utils';\n\ninterface OptionAria {\n  /** Props for the option element. */\n  optionProps: any;\n\n  /** Props for the main text element inside the option. */\n  labelProps: any;\n\n  /** Props for the description text element inside the option, if any. */\n  descriptionProps: any;\n}\n\ninterface AriaOptionProps {\n  /** Whether the option is disabled. */\n  'isDisabled'?: boolean;\n\n  /** Whether the option is selected. */\n  'isSelected'?: boolean;\n\n  /** A screen reader only label for the option. */\n  'aria-label'?: string;\n\n  /** The unique key for the option. */\n  'key'?: Key;\n\n  /** Whether selection should occur on press up instead of press down. */\n  'shouldSelectOnPressUp'?: boolean;\n\n  /** Whether the option should be focused when the user hovers over it. */\n  'shouldFocusOnHover'?: boolean;\n\n  /** Whether the option is contained in a virtual scrolling listbox. */\n  'isVirtualized'?: boolean;\n\n  /** Whether the option should use virtual focus instead of being focused directly. */\n  'shouldUseVirtualFocus'?: boolean;\n}\n\n/**\n * Provides the behavior and accessibility implementation for an option in a listbox.\n * See `useListBox` for more details about listboxes.\n * @param props - Props for the option.\n * @param state - State for the listbox, as returned by `useListState`.\n */\nexport function useOption<T>(\n  props: AriaOptionProps,\n  state: ListState<T>,\n  ref: RefObject<HTMLElement>\n): OptionAria {\n  let {\n    isSelected,\n    isDisabled,\n    key,\n    shouldSelectOnPressUp,\n    shouldFocusOnHover,\n    isVirtualized,\n    shouldUseVirtualFocus,\n  } = props;\n\n  let labelId = useSlotId();\n  let descriptionId = useSlotId();\n\n  let _optionProps: any = {\n    'role': 'option',\n    'aria-disabled': isDisabled,\n    'aria-selected': isSelected,\n  };\n\n  // Safari with VoiceOver on macOS misreads options with aria-labelledby or aria-label as simply \"text\".\n  // We should not map slots to the label and description on Safari and instead just have VoiceOver read the textContent.\n  // https://bugs.webkit.org/show_bug.cgi?id=209279\n  if (!(isMac() && isWebKit())) {\n    _optionProps['aria-label'] = props['aria-label'];\n    _optionProps['aria-labelledby'] = labelId;\n    _optionProps['aria-describedby'] = descriptionId;\n  }\n\n  if (isVirtualized) {\n    //@ts-ignore\n    _optionProps['aria-posinset'] = state.collection.getItem(key).index + 1;\n    _optionProps['aria-setsize'] = getItemCount(state.collection);\n  }\n\n  let { itemProps } = useSelectableItem({\n    selectionManager: state.selectionManager,\n    //@ts-ignore\n    key,\n    ref,\n    shouldSelectOnPressUp,\n    isVirtualized,\n    shouldUseVirtualFocus,\n  });\n\n  let { pressProps } = usePress({\n    ...itemProps,\n    isDisabled,\n    preventFocusOnPress: shouldUseVirtualFocus,\n  });\n\n  let { hoverProps } = useHover(\n    {\n      isDisabled: isDisabled || !shouldFocusOnHover,\n      onHoverStart() {\n        if (!isFocusVisible()) {\n          state.selectionManager.setFocused(true);\n          //@ts-ignore\n          state.selectionManager.setFocusedKey(key);\n        }\n      },\n    },\n    ref\n  );\n\n  // Putting this as a last resort, after several hours of debugging.\n  // Why?\n  // tabListProps adds onMouseDown with preventDefault in useSelectableCollection.ts (React Aria) and react-native-web uses onClick for onPress.\n  // This results in tab button not getting focused when clicked\n  // See this example - https://codesandbox.io/s/issue-i-know-but-dont-know-why-1-ydyw5?file=/src/App.js\n  const onMouseDown = (e: any) => e.stopPropagation();\n\n  _optionProps = {\n    ..._optionProps,\n    ...mergeProps(pressProps, hoverProps),\n    //@ts-ignore\n    id: getItemId(state, key),\n    onMouseDown,\n  };\n\n  const optionProps = useMapDomPropsToRN(_optionProps, ref);\n\n  return {\n    optionProps,\n    labelProps: {\n      nativeID: labelId,\n    },\n    descriptionProps: {\n      nativeID: descriptionId,\n    },\n  };\n}\n"]},"metadata":{},"sourceType":"module"}